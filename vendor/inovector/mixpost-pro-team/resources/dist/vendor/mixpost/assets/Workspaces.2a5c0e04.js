import{N as z,o as c,c as m,a as s,d as A,u as J,i as P,q as Z,I as S,J as G,cp as B,ae as H,af as x,l as b,al as D,R as K,b as t,e as l,w as o,g as v,j as O,F as R,r as Q,Z as X,f as p,t as g,V as M,h as f,k as y,aW as Y,m as ee,n as se}from"./app.3dbb9f4f.js";import{u as te}from"./useSelectable.1e30f95c.js";import{_ as oe}from"./Admin.8227e551.js";import{_ as re}from"./PageHeader.5278f6a5.js";import{_ as W}from"./PureDangerButton.aa10c267.js";import{_ as I}from"./Panel.1435ce07.js";import{_ as ae}from"./SelectableBar.3cd2e649.js";import{T}from"./Trash.108c227d.js";import{_ as le}from"./Pagination.b044d7e9.js";import{_ as ne}from"./SearchInput.2b4b1fa0.js";import{_ as ie}from"./Alert.68363348.js";import{_ as ce}from"./Flex.781629fc.js";import"./QueueList.71914ee1.js";import"./ChevronLeft.cbb2bb07.js";const de={class:"flex items-center"},pe={__name:"Filters",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(_,{emit:n}){return z(()=>0),(d,i)=>(c(),m("div",de,[s(ne,{modelValue:_.modelValue.keyword,"onUpdate:modelValue":i[0]||(i[0]=k=>_.modelValue.keyword=k),placeholder:d.$t("general.search")},null,8,["modelValue","placeholder"])]))}},ue={class:"w-full mx-auto row-py"},fe={class:"mt-lg row-px w-full"},me=["href"],_e={style:{display:"flex","flex-wrap":"wrap","justify-content":"flex-start"}},ke={style:{display:"flex","justify-content":"center","margin-bottom":"10px",padding:"0"}},we={style:{display:"flex","justify-content":"space-between"}},he={style:{flex:"1","border-right":"1px solid #E5E4E2","border-top":"1px solid #E5E4E2","margin-right":"-1px",display:"flex","justify-content":"center","align-items":"center"}},ge={style:{flex:"1","border-right":"1px solid #E5E4E2","border-top":"1px solid #E5E4E2","margin-right":"-1px",display:"flex","justify-content":"center","align-items":"center"}},ye={style:{flex:"1","border-top":"1px solid #E5E4E2",display:"flex","justify-content":"center","align-items":"center"}},xe={key:1,class:"mt-lg"},be=A({layout:oe}),Ie=Object.assign(be,{__name:"Workspaces",props:{workspaces:{type:Object},filter:{type:Object,default:{}}},setup(_){const{t:n}=J(),d=P("routePrefix"),i=_,k=n("workspace.workspaces"),U=P("confirmation"),{notify:q}=se(),{enterpriseConsole:$}=Z(),{selectedRecords:w,putPageRecords:E,toggleSelectRecordsOnPage:ve,deselectRecord:L,deselectAllRecords:C}=te(),V=()=>i.workspaces.data.map(e=>e.uuid),h=S({keyword:i.filter.keyword});G(()=>{E(V()),B.on("workspaceDelete",e=>{L(e)}),i.workspaces.data.forEach(e=>{F(e.id)})}),H(()=>{B.off("workspaceDelete")}),x(()=>i.workspaces.data,()=>{E(V())}),x(()=>b.exports.cloneDeep(h.value),b.exports.throttle(()=>{D.get(route(`${d}.workspaces.index`),b.exports.pickBy(h.value),{preserveState:!0,only:["workspaces","filter"]})},300));const j=e=>{w.value.includes(e)||w.value.push(e),U().title(n("workspace.delete_workspaces")).description(n("workspace.confirm_delete_workspaces")).destructive().onConfirm(r=>{r.isLoading(!0),D.delete(route(`${d}.workspaces.deleteMultiple`),{data:{workspaces:w.value},preserveScroll:!0,onSuccess(){C(),q("success",n("workspace.workspaces_deleted"))},onFinish(){r.reset()}})}).show()},u=S({}),F=async e=>{try{const r=await axios.get(`workspaces/posts/count/${e}`);u.value[e]=r.data.count}catch(r){console.error("Error fetching posts count:",r)}};return x(()=>i.workspaces.data,e=>{e.forEach(r=>{u.value[r.id]||F(r.id)})}),(e,r)=>{const N=K("tooltip");return c(),m(R,null,[s(t(X),{title:t(k)},null,8,["title"]),l("div",ue,[s(re,{title:t(k)},{description:o(()=>[p(g(t(n)("workspace.manage_brands_businesses")),1)]),_:1},8,["title"]),l("div",fe,[s(ae,{count:t(w).length,onClose:t(C)},{default:o(()=>[M((c(),v(W,{onClick:j},{default:o(()=>[s(T)]),_:1})),[[N,t(n)("general.delete")]])]),_:1},8,["count","onClose"]),t($).url?(c(),v(ie,{key:0,variant:"warning",closeable:!1,class:"mb-lg"},{default:o(()=>[p(" Manage Workspaces from the "),l("a",{href:`${t($).url}/workspaces`,class:"link"},"Enterprise Console",8,me),p(" for more business actions. ")]),_:1})):O("",!0),s(ce,{class:"justify-between"},{default:o(()=>[s(t(f),{href:e.route(`${t(d)}.workspaces.create`),class:"mb-xs sm:mb-0"},{default:o(()=>[s(y,null,{default:o(()=>[p(g(t(n)("workspace.create_workspace")),1)]),_:1})]),_:1},8,["href"]),s(pe,{modelValue:h.value,"onUpdate:modelValue":r[0]||(r[0]=a=>h.value=a)},null,8,["modelValue"])]),_:1}),l("div",_e,[(c(!0),m(R,null,Q(e.$page.props.workspaces.data,a=>(c(),m("div",{key:a.uuid,style:{flex:"0 0 calc(33.33% - 30px)","max-width":"400px",margin:"10px"}},[s(t(f),{href:e.route("br.switchWorkspace",{workspace:a.uuid,redirect:!0}),method:"post","with-padding":!1},{default:o(()=>[s(I,{"with-padding":!1,style:{padding:"0px"}},{default:o(()=>[l("div",{style:Y({display:"flex",justifyContent:"center",alignItems:"center",height:"150px",backgroundColor:"#FFFFFF",border:"2px solid "+a.hex_color,margin:"15px"})},g(a.name),5),l("div",ke,[s(y,{style:{width:"90%","background-color":"#f4BC1C",border:"none",color:"black"}},{default:o(()=>[p(g(u.value[a.id]!==void 0&&u.value[a.id]>0?`${u.value[a.id]} Posts this week`:"No Posts this week"),1)]),_:2},1024)]),l("div",we,[l("div",he,[s(t(f),{href:"#",onClick:ee($e=>j(a.uuid),["stop"]),class:"mr-xs"},{default:o(()=>[M((c(),v(W,{style:{"background-color":"transparent",border:"none",color:"gray"}},{default:o(()=>[s(T)]),_:1})),[[N,t(n)("general.delete")]])]),_:2},1032,["onClick"])]),l("div",ge,[s(t(f),{href:e.route(`${t(d)}.workspaces.edit`,{workspace:a.uuid}),class:"mr-xs"},{default:o(()=>[s(y,{style:{"background-color":"transparent",border:"none",color:"gray"}},{default:o(()=>[p("Edit")]),_:1})]),_:2},1032,["href"])]),l("div",ye,[s(t(f),{href:e.route(`${t(d)}.workspaces.view`,{workspace:a.uuid}),class:"mr-xs"},{default:o(()=>[s(y,{style:{"background-color":"transparent",border:"none",color:"gray"}},{default:o(()=>[p("Manage")]),_:1})]),_:2},1032,["href"])])])]),_:2},1024)]),_:2},1032,["href"])]))),128))]),s(I,{"with-padding":!1,class:"mt-lg"}),e.$page.props.workspaces.meta.links.length>3?(c(),m("div",xe,[s(le,{meta:e.$page.props.workspaces.meta,links:e.$page.props.workspaces.links},null,8,["meta","links"])])):O("",!0)])])],64)}}});export{Ie as default};
