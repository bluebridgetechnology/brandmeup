import{u as F,i as x,a6 as q,I as A,R as E,o,c as k,e as I,V as L,b as s,g as p,w as t,a as e,ag as N,ak as H,f as m,t as i,j as V,ah as K,al as C,cp as O,A as Q,cs as W,an as X,N as Y,d as ee,J as te,ae as se,af as P,l as U,F as R,Z as ae,h as le,k as re,aE as T,r as oe,n as ne}from"./app.3dbb9f4f.js";import{_ as ie}from"./Admin.8227e551.js";import{u as ue}from"./useSelectable.1e30f95c.js";import{_ as ce}from"./PageHeader.5278f6a5.js";import{_ as de}from"./PureDangerButton.aa10c267.js";import{_ as me}from"./Panel.1435ce07.js";import{_ as B}from"./Checkbox.1a8805b0.js";import{_ as n,a as M,T as fe}from"./TableCell.4ea0e0fc.js";import{_ as _e}from"./PureButtonLink.52cd3818.js";import{E as pe}from"./Eye.96ec91e4.js";import{T as J}from"./Trash.108c227d.js";import{_ as he}from"./DropdownButton.3e12eb5b.js";import{_ as $e}from"./SelectableBar.3cd2e649.js";import{_ as ke}from"./NoResult.f7bfb2e6.js";import{_ as ve}from"./Pagination.b044d7e9.js";import{_ as ge}from"./SearchInput.2b4b1fa0.js";import{_ as be}from"./Flex.781629fc.js";import"./QueueList.71914ee1.js";import"./EllipsisVertical.6eb78bb2.js";import"./ChevronLeft.cbb2bb07.js";const ye={class:"flex flex-row items-center justify-end gap-xs"},we={__name:"UserItemAction",props:{itemId:{type:Number,required:!0}},emits:["onDelete"],setup(a,{emit:l}){const{t:r}=F(),u=x("routePrefix"),h=x("confirmation"),v=a,D=l,{user:g}=q(),_=A(!1),b=()=>{h().title(r("user.delete_user")).description(r("user.confirm_delete_user")).destructive().onConfirm(c=>{c.isLoading(!0),C.delete(route(`${u}.users.delete`,{user:v.itemId}),{onSuccess(){_.value=!1,D("onDelete"),O.emit("userDelete",v.itemId),c.reset()},onFinish(){c.close()}})}).show()};return(c,j)=>{const y=E("tooltip");return o(),k("div",null,[I("div",ye,[L((o(),p(_e,{href:c.route(`${s(u)}.users.view`,{user:a.itemId})},{default:t(()=>[e(pe)]),_:1},8,["href"])),[[y,s(r)("general.view")]]),e(K,{"width-classes":"w-32",placement:"bottom-end"},{trigger:t(()=>[e(he)]),content:t(()=>[e(N,{href:c.route(`${s(u)}.users.edit`,{user:a.itemId})},{default:t(()=>[e(H,{class:"mr-xs"}),m(" "+i(s(r)("general.edit")),1)]),_:1},8,["href"]),s(g).id!==a.itemId?(o(),p(N,{key:0,onClick:b,as:"button"},{default:t(()=>[e(J,{class:"text-red-500 mr-xs"}),m(" "+i(s(r)("general.delete")),1)]),_:1})):V("",!0)]),_:1})])])}}},xe={__name:"UserItem",props:{item:{type:Object,required:!0}},setup(a){return(l,r)=>(o(),p(M,{hoverable:!0},{default:t(()=>[e(n,{class:"w-10"},{default:t(()=>[Q(l.$slots,"checkbox")]),_:3}),e(n,null,{default:t(()=>[e(W,{name:a.item.name},null,8,["name"])]),_:1}),e(n,null,{default:t(()=>[I("div",null,i(a.item.name),1),a.item.is_admin?(o(),p(X,{key:0,class:"mt-xs"},{default:t(()=>[m(i(l.$t("user.system_admin")),1)]),_:1})):V("",!0)]),_:1}),e(n,null,{default:t(()=>[m(i(a.item.email),1)]),_:1}),e(n,null,{default:t(()=>[m(i(a.item.created_at),1)]),_:1}),e(n,null,{default:t(()=>[e(we,{itemId:a.item.id},null,8,["itemId"])]),_:1})]),_:3}))}},Ie={class:"flex items-center"},Ve={__name:"Filters",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(a,{emit:l}){return Y(()=>0),(r,u)=>(o(),k("div",Ie,[e(ge,{modelValue:a.modelValue.keyword,"onUpdate:modelValue":u[0]||(u[0]=h=>a.modelValue.keyword=h),placeholder:r.$t("general.search")},null,8,["modelValue","placeholder"])]))}},De={class:"w-full mx-auto row-py"},je={class:"mt-lg row-px w-full"},Ue={key:0,class:"mt-lg"},Ce=ee({layout:ie}),We=Object.assign(Ce,{__name:"Users",props:{users:{type:Object},filter:{type:Object,default:{}}},setup(a){const{t:l}=F(),r=x("routePrefix"),u=a,h=l("user.users"),{notify:v}=ne(),D=x("confirmation"),{user:g}=q(),{selectedRecords:_,putPageRecords:b,toggleSelectRecordsOnPage:c,deselectRecord:j,deselectAllRecords:y}=ue(),S=()=>u.users.data.filter(d=>d.id!==g.value.id).map(d=>d.id),w=A({keyword:u.filter.keyword});te(()=>{b(S()),O.on("userDelete",d=>{j(d)})}),se(()=>{O.off("userDelete")}),P(()=>u.users.data,()=>{b(S())}),P(()=>U.exports.cloneDeep(w.value),U.exports.throttle(()=>{C.get(route(`${r}.users.index`),U.exports.pickBy(w.value),{preserveState:!0,only:["users","filter"]})},300));const Z=()=>{D().title(l("user.delete_users")).description(l("user.confirm_delete_users")).destructive().onConfirm(d=>{d.isLoading(!0),C.delete(route(`${r}.users.deleteMultiple`),{data:{users:_.value},preserveScroll:!0,onSuccess(){y(),v("success",l("user.selected_users_deleted"))},onFinish(){d.reset()}})}).show()};return(d,$)=>{const z=E("tooltip");return o(),k(R,null,[e(s(ae),{title:s(h)},null,8,["title"]),I("div",De,[e(ce,{title:s(h)},{description:t(()=>[m(i(s(l)("user.manage_users")),1)]),_:1},8,["title"]),I("div",je,[e($e,{count:s(_).length,onClose:s(y)},{default:t(()=>[L((o(),p(de,{onClick:Z},{default:t(()=>[e(J)]),_:1})),[[z,s(l)("general.delete")]])]),_:1},8,["count","onClose"]),e(be,{class:"justify-between"},{default:t(()=>[e(s(le),{href:d.route(`${s(r)}.users.create`),class:"mb-xs sm:mb-0"},{default:t(()=>[e(re,null,{default:t(()=>[m(i(s(l)("user.create_user")),1)]),_:1})]),_:1},8,["href"]),e(Ve,{modelValue:w.value,"onUpdate:modelValue":$[0]||($[0]=f=>w.value=f)},null,8,["modelValue"])]),_:1}),e(me,{"with-padding":!1,class:"mt-lg"},{default:t(()=>[e(fe,null,{head:t(()=>[e(M,null,{default:t(()=>[e(n,{component:"th",scope:"col",class:"w-10"},{default:t(()=>[e(B,{checked:s(c),"onUpdate:checked":$[1]||($[1]=f=>T(c)?c.value=f:null),disabled:!a.users.meta.total},null,8,["checked","disabled"])]),_:1}),e(n,{component:"th",scope:"col"}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.name")),1)]),_:1}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.email")),1)]),_:1}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.created_at")),1)]),_:1}),e(n,{component:"th",scope:"col"})]),_:1})]),body:t(()=>[(o(!0),k(R,null,oe(a.users.data,f=>(o(),p(xe,{key:f.id,item:f,onOnDelete:()=>{s(j)(f.id)}},{checkbox:t(()=>[e(B,{checked:s(_),"onUpdate:checked":$[2]||($[2]=G=>T(_)?_.value=G:null),value:f.id,disabled:f.id===s(g).id,number:""},null,8,["checked","value","disabled"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),a.users.meta.total?V("",!0):(o(),p(ke,{key:0,table:""}))]),_:1}),a.users.meta.links.length>3?(o(),k("div",Ue,[e(ve,{meta:a.users.meta,links:a.users.links},null,8,["meta","links"])])):V("",!0)])])],64)}}});export{We as default};
