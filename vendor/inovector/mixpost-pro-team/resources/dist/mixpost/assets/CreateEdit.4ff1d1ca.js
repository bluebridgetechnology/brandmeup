import{u as O,l as q,bJ as z,i as G,I as J,T as M,N as Y,c as g,a,b as e,e as n,w as s,m as Z,F as $,o as m,Z as H,g as w,f as p,t as c,k as C,j as k,S as K,h as Q,Y as R,ab as W,r as X,a1 as y,al as T,n as ee}from"./app.3dbb9f4f.js";import{u as te}from"./usePostVersions.f18e2fc4.js";import{u as ae}from"./Variable.cb6cad2c.js";import{u as se}from"./useTemplate.8ac1edac.js";import{_ as oe}from"./PageHeader.5278f6a5.js";import{_ as re}from"./Panel.1435ce07.js";import{_ as le}from"./LabelSuffix.6a36f138.js";import{V as ie}from"./VerticalGroup.1aa58a90.js";import{_ as ne,a as me,b as pe,c as de,d as ue,e as ce}from"./VariableManager.15c574d0.js";import{T as fe}from"./Trash.108c227d.js";import{_ as _e}from"./Flex.781629fc.js";import"./index.d961b7a1.js";import"./index.bd465a20.js";import"./vue.runtime.esm-bundler.d43166be.js";import"./MediaGifs.98eb8be9.js";import"./index.browser.8e74d592.js";import"./Masonry.1a75e465.js";import"./MediaFile.dd3a1c78.js";import"./ExclamationCircle.5d8a3fe5.js";import"./SectionTitle.453db892.js";import"./SearchInput.2b4b1fa0.js";import"./NoResult.f7bfb2e6.js";import"./Alert.68363348.js";import"./Tab.87218907.js";import"./EllipsisVertical.6eb78bb2.js";import"./ListItem.b96016ef.js";import"./Textarea.2260d931.js";const ve={class:"w-full mx-auto row-py"},be={class:"flex"},xe={class:"mt-lg row-px w-full"},we={for:"template_name"},ke={class:"form-field"},ye={class:"relative flex items-center justify-between border-t border-gray-200 pt-md mt-md"},ge={class:"flex items-center space-x-xs"},Qe={__name:"CreateEdit",props:["template"],setup(j){const{t:o}=O(),d=j,l=d.template?q.exports.cloneDeep(d.template):null;z("postCtx",{});const f=G("workspaceCtx"),{notify:b}=ee(),{versionContentObject:h}=te(),{insertEmoji:S,insertContent:I,focusEditor:B}=ae(),{createPost:A,formatTemplateContent:D,deleteTemplate:F}=se(),u=J(!1),_=M({name:l?l.name:"",content:l?l.content:[h()]}),V=Y(()=>d.template?o("template.edit_template"):o("template.create_new_template")),x=()=>({name:_.name,content:D(_.content)}),P=()=>{d.template||E(x()),d.template&&U(x())},E=(v,t=!1)=>{y.start(),u.value=!0,axios.post(route("br.templates.api.store",{workspace:f.id}),v).then(r=>{if(b("success",o("template.template_created")),!t){T.get(route("br.templates.edit",{workspace:f.id,template:r.data.id}),{},{preserveScroll:!0});return}T.get(route("br.templates.create",{workspace:f.id}))}).finally(()=>{y.done(),u.value=!1})},U=v=>{y.start(),u.value=!0,axios.put(route("br.templates.api.update",{workspace:f.id,template:d.template.id}),v).then(()=>{b("success",o("template.template_updated"))}).catch(t=>{if(t.response.status!==422){b("error",t.response.data.message);return}b("error",o("template.error_saving_template"))}).finally(()=>{y.done(),u.value=!1})};return(v,t)=>(m(),g($,null,[a(e(H),{title:V.value},null,8,["title"]),n("div",ve,[a(oe,{title:V.value},{default:s(()=>[n("div",be,[e(l)?(m(),w(C,{key:0,onClick:t[0]||(t[0]=()=>{e(A)(x().content)}),class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.use_template")),1)]),_:1})):k("",!0),e(l)?(m(),w(e(Q),{key:1,href:v.route("br.templates.create",{workspace:e(f).id})},{default:s(()=>[a(K,{class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.create_new")),1)]),_:1})]),_:1},8,["href"])):k("",!0),e(l)?(m(),w(R,{key:2,onClick:t[1]||(t[1]=()=>{e(F)(e(l))}),size:"sm"},{default:s(()=>[a(fe)]),_:1})):k("",!0)])]),_:1},8,["title"]),n("div",xe,[n("form",{onSubmit:Z(P,["prevent"])},[a(re,null,{title:s(()=>[p(c(e(o)("general.details")),1)]),default:s(()=>[a(ie,{class:"mb-lg !max-w-full"},{title:s(()=>[n("label",we,[p(c(e(o)("template.template_name"))+" ",1),a(le,{danger:!0},{default:s(()=>[p("*")]),_:1})])]),default:s(()=>[a(W,{type:"text",modelValue:e(_).name,"onUpdate:modelValue":t[2]||(t[2]=r=>e(_).name=r),id:"template_name",required:""},null,8,["modelValue"])]),_:1}),n("div",ke,[(m(!0),g($,null,X(e(_).content,(r,L)=>(m(),g($,{key:L},[a(ne,{id:"templateEditor",value:r.body,editable:!0,onUpdate:N=>r.body=N,placeholder:e(o)("post.type_something")},{default:s(N=>[n("div",ye,[n("div",ge,[a(me,{onSelected:t[3]||(t[3]=i=>e(S)({editorId:"templateEditor",emoji:i})),onClose:t[4]||(t[4]=i=>e(B)({editorId:"templateEditor"}))}),a(pe,{onInsert:i=>r.media=[...r.media,...i],selectedAccounts:[],activeVersion:0,versions:[],media:r.media},null,8,["onInsert","media"]),a(de,{editAllowed:!0,onInsert:t[5]||(t[5]=i=>e(I)({editorId:"templateEditor",text:i}))}),a(ue,{editAllowed:!0,onInsert:t[6]||(t[6]=i=>e(I)({editorId:"templateEditor",text:i}))})])])]),_:2},1032,["value","onUpdate","placeholder"]),a(ce,{media:r.media},null,8,["media"])],64))),128))]),a(_e,{responsive:!1,class:"items-center"},{default:s(()=>[a(C,{disabled:u.value,type:"submit",class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.save_template")),1)]),_:1},8,["disabled"]),e(l)?k("",!0):(m(),w(C,{key:0,onClick:t[7]||(t[7]=()=>{E(x(),!0)}),disabled:u.value,type:"button"},{default:s(()=>[p(c(e(o)("template.save_create_new")),1)]),_:1},8,["disabled"]))]),_:1})]),_:1})],32)])])],64))}};export{Qe as default};
