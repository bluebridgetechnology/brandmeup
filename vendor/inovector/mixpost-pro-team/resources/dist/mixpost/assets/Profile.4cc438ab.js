import{u as E,o as r,c as _,F as $,r as S,g as C,$ as F,a as t,w as e,f as o,t as s,b as l,e as a,j as y,_ as x,k as V,cy as oe,n as H,a6 as ae,T as Q,ab as D,m as re,i as se,S as G,ac as ne,I as b,N as ie,ap as ue,an as ee,Y as ce,d as de,Z as fe,h as me}from"./app.3dbb9f4f.js";import{_ as _e}from"./Minimal.3c70d183.js";import{_ as R}from"./Radio.02f44a14.js";import{_ as te}from"./Select.2234a951.js";import{_ as N}from"./Flex.781629fc.js";import{_ as q,a as ve}from"./ActionSection.e40800e0.js";import{_ as O}from"./SectionBorder.96a5b39e.js";import{_ as pe}from"./PageHeader.5278f6a5.js";import{A as ge}from"./ArrowLeft.34b8ab3d.js";import"./InputHidden.428c3568.js";import"./Eye.96ec91e4.js";import"./Panel.1435ce07.js";const he=["value"],be={key:0,class:"text-xs text-gray-500 mt-xs block"},ye={class:"font-medium"},we=["label"],$e=["value"],ke={class:"flex items-center space-x-sm"},Ce={class:"flex items-center space-x-sm"},xe={__name:"Preferences",props:{form:{type:Object,require:!0},locales:{type:Array,required:!0},timezone_list:{type:Object,required:!0}},setup(n){const i=E(),{t:f}=i,u=n,v=h=>u.locales.find(m=>m.long===h).direction||"ltr",p=h=>!["en-GB","fr-CA","ar-SA","de-DE","es-MX"].includes(h),{notify:w}=H(),g=()=>{u.form.put(route("br.profile.updatePreferences"),{preserveScroll:!0,onSuccess(){oe.changeLocale(i,u.form.locale,v(u.form.locale)),w("success",f("profile.preferences_updated"))}})};return(h,m)=>(r(),_("div",null,[(r(!0),_($,null,S(n.form.errors,c=>(r(),C(F,{message:c,class:"mb-xs"},null,8,["message"]))),256)),t(x,null,{title:e(()=>[o(s(l(f)("general.language")),1)]),default:e(()=>[a("div",null,[t(te,{modelValue:n.form.locale,"onUpdate:modelValue":m[0]||(m[0]=c=>n.form.locale=c)},{default:e(()=>[(r(!0),_($,null,S(n.locales,c=>(r(),_("option",{value:c.long},s(c.english)+" - "+s(c.native)+" - ("+s(c.long)+") "+s(p(c.long)?"[Beta]":""),9,he))),256))]),_:1},8,["modelValue"]),p(n.form.locale)?(r(),_("span",be,[o(" \u{1F6A7} Language "),a("span",ye,s(n.form.locale),1),o(" is in beta and may not be fully translated or can contain errors. ")])):y("",!0)])]),_:1}),t(x,{class:"mt-lg"},{title:e(()=>[o(s(l(f)("general.timezone")),1)]),default:e(()=>[a("div",null,[t(te,{modelValue:n.form.timezone,"onUpdate:modelValue":m[1]||(m[1]=c=>n.form.timezone=c)},{default:e(()=>[(r(!0),_($,null,S(n.timezone_list,(c,L)=>(r(),_("optgroup",{label:L},[(r(!0),_($,null,S(c,(P,I)=>(r(),_("option",{value:I},s(P),9,$e))),256))],8,we))),256))]),_:1},8,["modelValue"])])]),_:1}),t(x,{class:"mt-lg"},{title:e(()=>[o(s(l(f)("profile.time_format")),1)]),default:e(()=>[a("div",ke,[a("label",null,[t(R,{checked:n.form.time_format,"onUpdate:checked":m[2]||(m[2]=c=>n.form.time_format=c),value:12},null,8,["checked"]),o(" 12 "+s(l(f)("profile.hour")),1)]),a("label",null,[t(R,{checked:n.form.time_format,"onUpdate:checked":m[3]||(m[3]=c=>n.form.time_format=c),value:24},null,8,["checked"]),o(" 24 "+s(l(f)("profile.hour")),1)])])]),_:1}),t(x,{class:"mt-lg"},{title:e(()=>[o(s(l(f)("profile.first_day_week")),1)]),default:e(()=>[a("div",Ce,[a("label",null,[t(R,{checked:n.form.week_starts_on,"onUpdate:checked":m[4]||(m[4]=c=>n.form.week_starts_on=c),value:0},null,8,["checked"]),o(" "+s(l(f)("profile.sunday")),1)]),a("label",null,[t(R,{checked:n.form.week_starts_on,"onUpdate:checked":m[5]||(m[5]=c=>n.form.week_starts_on=c),value:1},null,8,["checked"]),o(" "+s(l(f)("profile.monday")),1)])])]),_:1}),t(V,{onClick:g,class:"mt-lg"},{default:e(()=>[o(s(l(f)("general.save")),1)]),_:1})]))}},Le={for:"name"},Ve={for:"email"},Pe={__name:"UserAccount",setup(n){const{t:i}=E(),{user:f}=ae(),{notify:u}=H(),v=Q({name:f.value.name,email:f.value.email}),p=()=>{v.put(route("br.profile.updateUser"),{preserveScroll:!0,onSuccess(){u("success",i("account.account_updated"))}})};return(w,g)=>(r(),_("form",{onSubmit:re(p,["prevent"])},[(r(!0),_($,null,S(l(v).errors,h=>(r(),C(F,{message:h,class:"mb-xs"},null,8,["message"]))),256)),t(x,null,{title:e(()=>[a("label",Le,s(l(i)("general.name")),1)]),default:e(()=>[t(D,{type:"text",modelValue:l(v).name,"onUpdate:modelValue":g[0]||(g[0]=h=>l(v).name=h),error:l(v).errors.name,id:"name"},null,8,["modelValue","error"])]),_:1}),t(x,{class:"mt-lg"},{title:e(()=>[a("label",Ve,s(l(i)("general.email")),1)]),default:e(()=>[t(D,{type:"email",modelValue:l(v).email,"onUpdate:modelValue":g[1]||(g[1]=h=>l(v).email=h),error:l(v).errors.email,id:"email"},null,8,["modelValue","error"])]),_:1}),t(V,{type:"submit",class:"mt-lg"},{default:e(()=>[o(s(l(i)("general.save")),1)]),_:1})],32))}},Ie={for:"password"},Se={__name:"ConfirmPassword",props:{show:{type:Boolean,default:!0}},emits:["close","confirm"],setup(n,{emit:i}){const f=se("routePrefix"),u=i,v=()=>{u("close")},p=Q({password:""}),w=()=>{p.post(route(`${f}.profile.confirmPassword`),{preserveScroll:!0,onSuccess(){u("confirm"),p.reset(),v()}})};return(g,h)=>(r(),C(ne,{show:n.show,"max-width":"lg",closeable:!0,"scrollable-body":!0,zIndexClass:"z-30",onClose:v},{header:e(()=>[o(s(g.$t("auth.confirm_password")),1)]),body:e(()=>[n.show?(r(),_($,{key:0},[a("div",null,s(g.$t("profile.security_confirm_password")),1),t(x,{class:"mt-lg"},{title:e(()=>[a("label",Ie,s(g.$t("auth.password")),1)]),footer:e(()=>[t(F,{message:l(p).errors.password},null,8,["message"])]),default:e(()=>[t(D,{modelValue:l(p).password,"onUpdate:modelValue":h[0]||(h[0]=m=>l(p).password=m),error:l(p).errors.password,type:"password",id:"password",class:"w-full",autocomplete:"password"},null,8,["modelValue","error"])]),_:1})],64)):y("",!0)]),footer:e(()=>[t(G,{onClick:v,class:"mr-xs"},{default:e(()=>[o(s(g.$t("general.cancel")),1)]),_:1}),t(V,{onClick:w,disabled:l(p).processing,isLoading:l(p).processing,class:"mr-xs"},{default:e(()=>[o(s(g.$t("general.confirm")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"]))}},Ue={class:"mt-lg"},ze={key:0,class:"mt-lg"},Ae=["innerHTML"],Be={class:"uppercase font-medium text-center"},Te={class:"text-gray-500"},je={class:"mt-md"},Re={for:"code"},Ne={key:1},qe={key:0,class:"mt-lg"},De={class:"mt-xs bg-primary-50 rounded-lg p-md"},Me={class:"mb-xs"},Oe={class:"font-medium"},Ee={__name:"TwoFactorAuth",setup(n){const{t:i}=E(),f=b({svg:"",secret_key:""}),u=b(!1),v=b(!1),p=b(""),w=b(!1),g=b(!1),h=b([]),m=b(!1),c=b(null),L=se("routePrefix"),{notify:P}=H(),I=ie(()=>v.value?!1:ue().props.user_has_two_factor_auth_enabled||u.value===!0),le=()=>{m.value=!0},X=()=>{m.value=!1},z=b(!1),Y=()=>{z.value=!0,axios.post(route(`${L}.profile.two-factor-auth.enable`)).then(d=>{w.value=!0,f.value=d.data}).catch(d=>U(d,Y)).finally(()=>z.value=!1)},A=b(!1),Z=()=>{A.value=!0,axios.post(route(`${L}.profile.two-factor-auth.confirm`),{code:p.value}).then(d=>{u.value=!0,v.value=!1,w.value=!1,h.value=d.data.recovery_codes,g.value=!0,p.value="",P("success",i("profile.two_factor_enabled"))}).catch(d=>U(d,Z)).finally(()=>A.value=!1)},B=b(!1),J=()=>{B.value=!0,axios.get(route(`${L}.profile.two-factor-auth.showRecoveryCodes`)).then(d=>{h.value=d.data.recovery_codes,g.value=!0}).catch(d=>U(d,J)).finally(()=>B.value=!1)},T=b(!1),K=()=>{T.value=!0,axios.post(route(`${L}.profile.two-factor-auth.regenerateRecoveryCodes`)).then(d=>{h.value=d.data.recovery_codes,g.value=!0}).catch(d=>U(d,K)).finally(()=>T.value=!1)},j=b(!1),W=()=>{j.value=!0,axios.delete(route(`${L}.profile.two-factor-auth.disable`)).then(()=>{v.value=!0,P("success",i("profile.two_factor_disabled"))}).catch(d=>U(d,W)).finally(()=>j.value=!1)},U=(d,k)=>{if(d.response.status===422){d.response.data.errors.confirm_password&&(c.value=k,le()),d.response.data.errors.code&&P("error",d.response.data.errors.code[0]);return}P("error",i("error.something_wrong"))};return(d,k)=>(r(),_($,null,[a("div",null,[a("div",null,s(l(i)("profile.install_totp")),1),a("div",Ue,[I.value?(r(),C(ee,{key:0,variant:"success"},{default:e(()=>[o(s(l(i)("general.enabled")),1)]),_:1})):y("",!0),I.value?y("",!0):(r(),C(ee,{key:1,variant:"error"},{default:e(()=>[o(s(l(i)("general.disabled")),1)]),_:1}))]),w.value?(r(),_("div",ze,[t(N,{class:"w-full relative rounded-lg border border-gray-200 p-xs"},{default:e(()=>[a("div",{innerHTML:f.value.svg},null,8,Ae),t(N,{class:"justify-center items-center w-full"},{default:e(()=>[a("div",Be,[a("div",Te,s(l(i)("profile.secret_key")),1),a("div",null,s(f.value.secret_key),1)])]),_:1})]),_:1}),a("div",je,s(l(i)("profile.scan_qr_code")),1),t(x,{class:"mt-lg"},{title:e(()=>[a("label",Re,s(l(i)("profile.code")),1)]),default:e(()=>[t(D,{modelValue:p.value,"onUpdate:modelValue":k[0]||(k[0]=M=>p.value=M),type:"text",id:"code",class:"w-full",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(N,null,{default:e(()=>[t(V,{onClick:Z,disabled:A.value,isLoading:A.value,class:"mt-lg"},{default:e(()=>[o(s(l(i)("general.confirm")),1)]),_:1},8,["disabled","isLoading"]),t(G,{onClick:k[1]||(k[1]=()=>{w.value=!1,p.value=""}),class:"mt-lg"},{default:e(()=>[o(s(l(i)("general.cancel")),1)]),_:1})]),_:1})])):y("",!0),I.value?(r(),_("div",Ne,[g.value?(r(),_("div",qe,[a("div",null,s(l(i)("profile.store_recovery_codes")),1),a("div",De,[(r(!0),_($,null,S(h.value,M=>(r(),_("div",Me,[a("div",Oe,s(M),1)]))),256))])])):y("",!0),t(N,{class:"mt-lg"},{default:e(()=>[g.value?(r(),C(V,{key:0,onClick:K,disabled:T.value,isLoading:T.value},{default:e(()=>[o(s(l(i)("profile.regenerate_recovery_codes")),1)]),_:1},8,["disabled","isLoading"])):y("",!0),g.value?y("",!0):(r(),C(V,{key:1,onClick:J,disabled:B.value,isLoading:B.value},{default:e(()=>[o(s(l(i)("profile.show_recovery_codes")),1)]),_:1},8,["disabled","isLoading"])),t(ce,{onClick:W,disabled:j.value,isLoading:j.value},{default:e(()=>[o(s(l(i)("general.disable")),1)]),_:1},8,["disabled","isLoading"])]),_:1})])):y("",!0),!I.value&&!w.value?(r(),C(V,{key:2,onClick:Y,disabled:z.value,isLoading:z.value,class:"mt-lg"},{default:e(()=>[o(s(l(i)("general.enable")),1)]),_:1},8,["disabled","isLoading"])):y("",!0)]),t(Se,{show:m.value,onConfirm:k[2]||(k[2]=()=>{X(),c.value&&c.value()}),onClose:X},null,8,["show"])],64))}},Fe={class:"row-py w-full mx-auto !pt-0"},He={class:"w-full mb-lg"},Qe={class:"mt-2xl sm:mt-0"},Ge={class:"mt-2xl sm:mt-0"},Xe={class:"mt-2xl sm:mt-0"},Ye={class:"mt-2xl sm:mt-0"},Ze=de({layout:_e}),ut=Object.assign(Ze,{__name:"Profile",props:["settings","locales","timezone_list","user_has_two_factor_auth_enabled"],setup(n){const f=Q(n.settings);return b("account"),(u,v)=>(r(),_($,null,[t(l(fe),{title:u.$t("profile.edit_profile")},null,8,["title"]),t(pe,{title:u.$t("profile.edit_profile"),class:"!px-0"},{default:e(()=>[t(l(me),{href:u.route("br.home"),class:"flex items-center link"},{default:e(()=>[t(G,{hiddenTextOnSmallScreen:!0},{icon:e(()=>[t(ge)]),default:e(()=>[o(" "+s(u.$t("profile.back_dashboard")),1)]),_:1})]),_:1},8,["href"])]),_:1},8,["title"]),a("div",Fe,[a("div",He,[a("div",Qe,[t(q,null,{title:e(()=>[o(s(u.$t("profile.profile_information")),1)]),description:e(()=>[o(s(u.$t("profile.update_your_account")),1)]),default:e(()=>[t(Pe)]),_:1})]),t(O,{contrasted:!0}),a("div",Ge,[t(q,null,{title:e(()=>[o(s(u.$t("profile.preferences")),1)]),description:e(()=>[o(s(u.$t("profile.update_preferences")),1)]),default:e(()=>[t(xe,{form:l(f),timezone_list:n.timezone_list,locales:n.locales},null,8,["form","timezone_list","locales"])]),_:1})]),u.$page.props.is_two_factor_auth_enabled?(r(),_($,{key:0},[t(O,{contrasted:!0}),a("div",Xe,[t(q,null,{title:e(()=>[o(s(u.$t("auth.two_factor_authentication")),1)]),description:e(()=>[o(s(u.$t("auth.security_using_two_factor")),1)]),default:e(()=>[t(Ee)]),_:1})])],64)):y("",!0),t(O,{contrasted:!0}),a("div",Ye,[t(q,null,{title:e(()=>[o(s(u.$t("auth.update_password")),1)]),description:e(()=>[o(s(u.$t("auth.confirm_secure_password")),1)]),default:e(()=>[t(ve)]),_:1})])])])],64))}});export{ut as default};
